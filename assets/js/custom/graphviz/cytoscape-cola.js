!function(){"use strict";var n=function(n,t){if(n&&t){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,i=function(n){return"number"==typeof n},a={animate:!0,refresh:1,maxSimulationTime:4e3,ungrabifyWhileSimulating:!1,fit:!0,padding:30,boundingBox:void 0,ready:function(){},stop:function(){},randomize:!1,avoidOverlap:!0,handleDisconnected:!0,nodeSpacing:function(n){return 10},flow:void 0,alignment:void 0,edgeLength:5,edgeSymDiffLength:void 0,edgeJaccardLength:void 0,unconstrIter:void 0,userConstIter:void 0,allConstIter:void 0,infinite:!1};o.prototype.run=function(){var n=this,a=this.options;n.manuallyStopped=!1;var o=a.cy,r=a.eles,c=r.nodes(),s=r.edges(),u=!1,d=a.boundingBox||{x1:0,y1:0,w:o.width(),h:o.height()};void 0===d.x2&&(d.x2=d.x1+d.w),void 0===d.w&&(d.w=d.x2-d.x1),void 0===d.y2&&(d.y2=d.y1+d.h),void 0===d.h&&(d.h=d.y2-d.y1);var f=function(n,t){return"function"==typeof n?n.apply(t,[t]):n},l=function(){for(var n=0;n<c.length;n++){var t=c[n],e=t.scratch("cola");if(!e.updatedDims){var r=f(a.nodeSpacing,t);e.width=t.outerWidth()+2*r,e.height=t.outerHeight()+2*r}}c.positions(function(n,t){var e,a=t.scratch().cola;return t.grabbed()||t.isParent()||(e={x:d.x1+a.x,y:d.y1+a.y},i(e.x)&&i(e.y)||(e=void 0)),e}),c.updateCompoundBounds(),u||(h(),u=!0),a.fit&&o.fit(a.padding)},p=function(){a.ungrabifyWhileSimulating&&w.grabify(),o.off("destroy",m),c.off("grab free position",v),c.off("lock unlock",x),n.one("layoutstop",a.stop),n.trigger({type:"layoutstop",layout:n})},h=function(){n.one("layoutready",a.ready),n.trigger({type:"layoutready",layout:n})},y=a.refresh;a.refresh<0?(Math.abs(a.refresh),y=1):y=Math.max(1,y);var g=n.adaptor=t.adaptor({trigger:function(n){var e=t.EventType?t.EventType.tick:null,i=t.EventType?t.EventType.end:null;switch(n.type){case"tick":case e:a.animate&&l();break;case"end":case i:l(),a.infinite||p()}},kick:function(){var t=function(){if(n.manuallyStopped)return p(),!0;var t=g.tick();return t&&a.infinite&&g.resume(),t};if(a.animate){var i=function(){(function(){for(var n,e=0;e<y&&!n;e++)n=n||t();return n})()||e(i)};e(i)}else for(;!t(););},on:function(n,t){},drag:function(){}});n.adaptor=g;var m,v,x,w=c.filter(":grabbable");a.ungrabifyWhileSimulating&&w.ungrabify(),o.one("destroy",m=function(t){n.stop()}),c.on("grab free position",v=function(n){var t=this.scratch().cola,e=this.position();switch(n.type){case"grab":g.dragstart(t),g.resume();break;case"free":g.dragend(t);break;case"position":t.x===e.x-d.x1&&t.y===e.y-d.y1||(t.px=e.x-d.x1,t.py=e.y-d.y1,g.resume())}}),c.on("lock unlock",x=function(n){var t=this.scratch().cola;t.fixed=this.locked(),this.locked()?g.dragstart(t):g.dragend(t)});var b,S,k=c.stdFilter(function(n){return!n.isParent()});if(g.nodes(k.map(function(n,t){var e=f(a.nodeSpacing,n),i=n.position(),o=n.boundingBox();return n.scratch().cola={x:a.randomize||void 0===i.x?Math.round(Math.random()*d.w):i.x,y:a.randomize||void 0===i.y?Math.round(Math.random()*d.h):i.y,width:o.w+2*e,height:o.h+2*e,index:t,fixed:n.locked()}})),a.alignment){var L=[],D=[];k.forEach(function(n){var t=f(a.alignment,n),e=n.scratch().cola.index;t&&(null!=t.x&&L.push({node:e,offset:t.x}),null!=t.y&&D.push({node:e,offset:t.y}))});var F=[];L.length>0&&F.push({type:"alignment",axis:"x",offsets:L}),D.length>0&&F.push({type:"alignment",axis:"y",offsets:D}),g.constraints(F)}g.groups(c.stdFilter(function(n){return n.isParent()}).map(function(n,t){var e=f(a.nodeSpacing,n),i=function(t){return parseFloat(n.style("padding-"+t))},o=i("left")+e,r=i("right")+e,c=i("top")+e,s=i("bottom")+e;return n.scratch().cola={index:t,padding:Math.max(o,r,c,s),leaves:n.children().stdFilter(function(n){return!n.isParent()}).map(function(n){return n[0].scratch().cola.index}),fixed:n.locked()},n}).map(function(n){return n.scratch().cola.groups=n.children().stdFilter(function(n){return n.isParent()}).map(function(n){return n.scratch().cola.index}),n.scratch().cola})),null!=a.edgeLength?(b=a.edgeLength,S="linkDistance"):null!=a.edgeSymDiffLength?(b=a.edgeSymDiffLength,S="symmetricDiffLinkLengths"):null!=a.edgeJaccardLength?(b=a.edgeJaccardLength,S="jaccardLinkLengths"):(b=100,S="linkDistance");if(g.links(s.stdFilter(function(n){return!n.source().isParent()&&!n.target().isParent()}).map(function(n,t){var e=n.scratch().cola={source:n.source()[0].scratch().cola.index,target:n.target()[0].scratch().cola.index};return null!=b&&(e.calcLength=f(b,n)),e})),g.size([d.w,d.h]),null!=b&&g[S](function(n){return n.calcLength}),a.flow){var M;"string"==typeof a.flow?M={axis:a.flow,minSeparation:50}:i(a.flow)?M={axis:"y",minSeparation:a.flow}:!function(n){return null!=n&&typeof n==typeof{}}(a.flow)?M={axis:"y",minSeparation:50}:((M=a.flow).axis=M.axis||"y",M.minSeparation=null!=M.minSeparation?M.minSeparation:50),g.flowLayout(M.axis,M.minSeparation)}return n.trigger({type:"layoutstart",layout:n}),g.avoidOverlaps(a.avoidOverlap).handleDisconnected(a.handleDisconnected).start(a.unconstrIter,a.userConstIter,a.allConstIter),a.infinite||setTimeout(function(){n.manuallyStopped||g.stop()},a.maxSimulationTime),this},o.prototype.stop=function(){return this.adaptor&&(this.manuallyStopped=!0,this.adaptor.stop()),this},n("layout","cola",o)}function o(n){var t=this.options={};for(var e in a)t[e]=a[e];for(var e in n)t[e]=n[e]}};"undefined"!=typeof module&&module.exports&&(module.exports=n),"undefined"!=typeof define&&define.amd&&define("cytoscape-cola",function(){return n}),"undefined"!=typeof cytoscape&&"undefined"!=typeof cola&&n(cytoscape,cola)}();