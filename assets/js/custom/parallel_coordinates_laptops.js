var margin={top:70,right:50,bottom:10,left:70},width=document.getElementById("page_content").clientWidth-margin.left-margin.right,height=500-margin.top-margin.bottom,innerHeight=height-2,devicePixelRatio=window.devicePixelRatio||1,color=d3.scaleOrdinal().domain(["Apple","HP","Acer","Asus","Dell","Lenovo","Chuwi","MSI","Microsoft","Toshiba","Huawei","Xiaomi","Vero","Razer","Mediacom","Samsung","Google","Fujitsu","LG"]).range(["#D27F8A","#50A9D4","#4CFC86","#C97D0B","#459248","#D26FA7","#E1525A","#5DB5B3","#785D82","#A8AF72","#954A56","#097AEB","#D8197D","#AB9E27","#D27D4B","#D98323","#BA8AAD","#35D468","#8FF6C2"]),types={Number:{key:"Number",coerce:function(e){return+e},extent:d3.extent,within:function(e,t,n){return t[0]<=n.scale(e)&&n.scale(e)<=t[1]},defaultScale:d3.scaleLinear().range([innerHeight,0])},String:{key:"String",coerce:String,extent:function(e){return e.sort()},within:function(e,t,n){return t[0]<=n.scale(e)&&n.scale(e)<=t[1]},defaultScale:d3.scalePoint().range([0,innerHeight])}},dimensions=[{key:"Company",description:"Company",type:types.String,axis:d3.axisLeft().tickFormat(function(e,t){return e})},{key:"Inches",description:"Screen Size (Inches)",type:types.Number},{key:"ScreenResolution_px",description:"Screen Resolution (Pixels)",type:types.String},{key:"Ram_GB",description:"Ram Memory (GB)",type:types.Number},{key:"SSD_Memory_GB",description:"SSD Memory (GB)",type:types.Number},{key:"HDD_Memory_GB",description:"HDD Memory (GB)",type:types.Number},{key:"Cpu_Type",description:"CPU Model",type:types.String},{key:"Cpu_Frequency_GHz",description:"CPU Clock Rate (GHz)",type:types.Number},{key:"Gpu_Type",description:"GPU Model",type:types.String},{key:"Price_euros",description:"Price (Euros)",type:types.Number}],xscale=d3.scalePoint().domain(d3.range(dimensions.length)).range([0,width]),yAxis=d3.axisLeft(),container=d3.select(".page__content").append("div").attr("class","parcoords").style("width",width+margin.left+margin.right+"px").style("height",height+margin.top+margin.bottom+"px"),svg=container.append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")"),canvas=container.append("canvas").attr("width",width*devicePixelRatio).attr("height",height*devicePixelRatio).style("width",width+"px").style("height",height+"px").style("margin-top",margin.top+"px").style("margin-left",margin.left+"px"),columns=[{head:"Company",cl:"title",key:"Company"},{head:"Screen Size (Inches)",cl:"num",key:"Inches"},{head:"Screen Resolution (Pixels)",cl:"center",key:"ScreenResolution_px"},{head:"Ram Memory (GB)",cl:"num",key:"Ram_GB"},{head:"SSD Memory (GB)",cl:"num",key:"SSD_Memory_GB"},{head:"HDD Memory (GB)",cl:"num",key:"HDD_Memory_GB"},{head:"CPU Model",cl:"center",key:"Cpu_Type"},{head:"CPU Clock Rate (GHz)",cl:"num",key:"Cpu_Frequency_GHz"},{head:"GPU Model",cl:"center",key:"Gpu_Type"},{head:"Price (Euros)",cl:"num",key:"Price_euros"}],table=d3.select(".page__content").append("table").attr("id","grid");table.append("thead").append("tr").selectAll("th").data(columns).enter().append("th").attr("class",function(e){return e.cl}).text(function(e){return e.head});var ctx=canvas.node().getContext("2d");ctx.globalCompositeOperation="darken",ctx.globalAlpha=.25,ctx.lineWidth=1.5,ctx.scale(devicePixelRatio,devicePixelRatio);var axes=svg.selectAll(".axis").data(dimensions).enter().append("g").attr("class",function(e){return"axis "+e.key.replace(/ /g,"_")}).attr("transform",function(e,t){return"translate("+xscale(t)+")"});function d3_functor(e){return"function"==typeof e?e:function(){return e}}d3.csv("../../assets/datasets/laptops_updated.csv",function(e,t){if(e)throw e;t.forEach(function(e){dimensions.forEach(function(t){e[t.key]=e[t.key]?t.type.coerce(e[t.key]):null})}),dimensions.forEach(function(e){"domain"in e||(e.domain=d3_functor(e.type.extent)(t.map(function(t){return t[e.key]}))),"scale"in e||(e.scale=e.type.defaultScale.copy()),e.scale.domain(e.domain)});var n=renderQueue(function(e){ctx.strokeStyle=color(e.Company),ctx.beginPath(),function(e){return dimensions.map(function(t,n){return t.key in e&&null!==e[t.key]?[xscale(n),t.scale(e[t.key])]:null})}(e).forEach(function(e,t){0!=t?ctx.lineTo(e[0],e[1]):ctx.moveTo(e[0],e[1])}),ctx.stroke()}).rate(30);ctx.clearRect(0,0,width,height),ctx.globalAlpha=d3.min([1.15/Math.pow(t.length,.3),1]),n(t),axes.append("g").each(function(e){var t="axis"in e?e.axis.scale(e.scale):yAxis.scale(e.scale);d3.select(this).call(t)}).append("text").attr("class","title").attr("text-anchor","start").text(function(e){return"description"in e?e.description:e.key}),axes.append("g").attr("class","brush").each(function(e){d3.select(this).call(e.brush=d3.brushY().extent([[-10,0],[10,height]]).on("start",i).on("brush",r).on("end",r))}).selectAll("rect").attr("x",-8).attr("width",16),d3.selectAll(".axis.Company .tick text").style("fill",color);table.append("tbody").selectAll("tr").data(t.sort(function(e,t){return d3.ascending(e.Price_euros,t.Price_euros)}).slice(0,5)).enter().append("tr").selectAll("td").data(function(e,t){return columns.map(function(t){var n={};return d3.keys(t).forEach(function(i){n[i]="key"==i?e[t[i]]:t[i]}),n})}).enter().append("td").html(function(e){return e.key}).attr("class",function(e){return e.cl});function i(){d3.event.sourceEvent.stopPropagation()}function r(){n.invalidate();var e=[];svg.selectAll(".axis .brush").filter(function(e){return d3.brushSelection(this)}).each(function(t){e.push({dimension:t,extent:d3.brushSelection(this)})});var i=t.filter(function(t){if(e.every(function(e){var n=e.dimension;return n.type.within(t[n.key],e.extent,n)}))return!0});ctx.clearRect(0,0,width,height),ctx.globalAlpha=d3.min([.85/Math.pow(i.length,.3),1]),n(i);var r=table.selectAll("tbody tr").data(i.sort(function(e,t){return d3.ascending(e.Price_euros,t.Price_euros)}).slice(0,5)).selectAll("td").data(function(e,t){return columns.map(function(t){var n={};return d3.keys(t).forEach(function(i){n[i]="key"==i?e[t[i]]:t[i]}),n})}).html(function(e){return e.key}).attr("class",function(e){return e.cl});r.enter().append("td").html(function(e){return e.key}),r.exit().remove()}});